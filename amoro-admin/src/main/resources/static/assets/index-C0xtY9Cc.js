
/*
  * Licensed to the Apache Software Foundation (ASF) under one
  * or more contributor license agreements.  See the NOTICE file
  * distributed with this work for additional information
  * regarding copyright ownership.  The ASF licenses this file
  * to you under the Apache License, Version 2.0 (the
  * "License"); you may not use this file except in compliance
  * with the License.  You may obtain a copy of the License at
  *
  *     http://www.apache.org/licenses/LICENSE-2.0
  *
  * Unless required by applicable law or agreed to in writing, software
  * distributed under the License is distributed on an "AS IS" BASIS,
  * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  * See the License for the specific language governing permissions and
  * limitations under the License.
  */

import{d as st,U as ft,a8 as ut,c as pt,w as bt,r as W,o as it,ae as et,W as yt,X as c,a0 as P,a3 as l,a6 as p,k as m,u as V,a2 as q,V as G,f as K,F as Q,a9 as Ut,Y as o,G as j,m as $t,A as wt,aa as lt,I as Lt,j as jt,af as It,ab as Kt,ac as qt,a7 as Gt,y as Ht,ag as Vt}from"./vue-BRgmPkyG.js";import{c as Wt,d as Yt,e as Zt,f as Jt,h as Qt,i as Xt,j as te,k as ee,l as ae,m as ne,n as oe}from"./table.service-CqCnYQuR.js";import{d as at,_ as dt,a as se,i as ie,f as xt,b as vt,u as le}from"./index-DOduU6Wt.js";import{p as mt,f as re,q as Tt,d as ce,e as ue,B as ht,r as St,s as kt,M as zt,a as de,k as pe,b as fe,D as me,I as he,t as _e,u as At,v as Nt,w as ge,S as ve,x as Pt,y as Ft,Q as ye,z as be}from"./antd-C8l4Woo2.js";import{u as rt}from"./usePagination-flyrWnsD.js";import{c as Ce,g as Ie}from"./dayjs-DZyl58SH.js";import{b as ot,o as ct}from"./common.type-BewOZShK.js";import{A as Te,C as Se,a as ke,b as $e,S as we,M as xe,P as Ee,c as De,d as Oe,e as Le,f as ze,g as Ae,h as Ne,i as Pe,j as Fe,k as Me,l as Re,m as Be,n as Ue,o as je,p as Ke,q as qe,r as Ge,s as He,t as Ve,u as We,v as Ye,w as Ze,x as Je,y as Qe,z as Xe,B as Et,D as ta,E as ea,F as aa,G as na,H as oa,I as sa,J as ia,K as la,L as ra,N as ca,O as ua,Q as da,R as pa,T as fa,U as ma,V as ha,W as _a,X as ga,Y as Mt,Z as va,_ as ya,$ as ba,a0 as Ca,a1 as Ia,a2 as Ta,a3 as Sa,a4 as ka,a5 as $a,a6 as wa,a7 as xa,a8 as Ea,a9 as Da,aa as Oa,ab as La,ac as za}from"./echarts-Bxroc4kM.js";import"./pinia-CrrsjVsv.js";import"./monaco-D3XgWC8G.js";import"./sql-C1XtL0KL.js";import"./axios-B4uVmeYG.js";const Aa={class:"table-detail g-flex"},Na={class:"left-content"},Pa={key:0,class:"table-attrs"},Fa={class:"attr-title"},Ma={key:1,class:"table-attrs"},Ra={class:"attr-title"},Ba={class:"table-attrs"},Ua={class:"attr-title"},ja={class:"right-content"},Ka={key:0,class:"table-attrs"},qa={class:"attr-title"},Ga={class:"table-attrs"},Ha={class:"attr-title"},Va={class:"table-attrs"},Wa={class:"attr-title"},Ya=st({__name:"Details",emits:["setBaseDetailInfo"],setup(I,{expose:y,emit:_}){const k=_,{t:s}=ft(),n=ut(),i=pt(()=>({...n.query}));bt(()=>n.query,r=>{r!=null&&r.catalog&&n.path==="/tables"&&b()});const t={fileCount:"File Count",totalSize:"Total Size",averageFileSize:"Average File Size",lastCommitTime:"Last Commit Time"},a={...t,baseWatermark:"Base Watermark"},u={...t,tableWatermark:"Table Watermark"},e=W({detailLoading:!1,baseDetailInfo:{optimizingStatus:"",tableType:"",tableName:"",createTime:"",tableFormat:"",hasPartition:!1},pkList:[],partitionColumnList:[],properties:[],changeMetrics:[],baseMetrics:[],schema:[]});async function b(){try{const{catalog:L,db:B,table:Y}=i.value;if(!L||!B||!Y)return;e.detailLoading=!0;const H=await Wt({...i.value}),{pkList:Z=[],tableType:w,partitionColumnList:f=[],properties:h,changeMetrics:R,schema:$,createTime:T,tableIdentifier:N,baseMetrics:U,tableSummary:X}=H;e.baseDetailInfo={...X,tableType:w,tableName:`${(N==null?void 0:N.catalog)||""}.${(N==null?void 0:N.database)||""}.${(N==null?void 0:N.tableName)||""}`,createTime:T?at(T):"",hasPartition:!!(f!=null&&f.length)},e.pkList=Z||[],e.partitionColumnList=f||[],e.schema=$||[],e.changeMetrics=Object.keys(u||{}).map(M=>({metric:u[M],value:M==="lastCommitTime"||M==="tableWatermark"?(R||{})[M]?at((R||{})[M]):"":(R||{})[M]})).filter(M=>M.value),e.baseMetrics=Object.keys(a||{}).map(M=>({metric:a[M],value:M==="lastCommitTime"||M==="baseWatermark"?(U||{})[M]?at((U||{})[M]):"":(U||{})[M]})),e.properties=Object.keys(h||{}).map(M=>({key:M,value:h[M]})),r()}catch{}finally{e.detailLoading=!1}function r(){k("setBaseDetailInfo",e.baseDetailInfo)}}it(()=>{b()}),y({getTableDetails:b});const d=et([{title:s("field"),dataIndex:"field",width:"30%"},{title:s("type"),dataIndex:"type",width:"20%"},{title:s("required"),dataIndex:"required",width:"20%",customRender:r=>String(r==null?void 0:r.value)},{title:s("description"),dataIndex:"comment",ellipsis:!0}]),O=et([{title:s("field"),dataIndex:"field",width:"30%"},{title:s("sourceField"),dataIndex:"sourceField",width:"30%"},{title:s("transform"),dataIndex:"transform",ellipsis:!0}]),E=et([{title:s("metric"),dataIndex:"metric",width:"50%",ellipsis:!0},{title:s("value"),dataIndex:"value",ellipsis:!0}]),A=et([{title:s("key"),dataIndex:"key",width:"50%",ellipsis:!0},{title:s("value"),dataIndex:"value",ellipsis:!0}]);return(r,L)=>{const B=mt,Y=yt("u-loading");return c(),P("div",Aa,[l("div",Na,[e.pkList&&e.pkList.length?(c(),P("div",Pa,[l("p",Fa,p(r.$t("primaryKey")),1),m(B,{"row-key":"field",columns:V(d),"data-source":e.pkList,pagination:!1},null,8,["columns","data-source"])])):q("",!0),e.partitionColumnList&&e.partitionColumnList.length?(c(),P("div",Ma,[l("p",Ra,p(r.$t("partitionKey")),1),m(B,{"row-key":"field",columns:V(O),"data-source":e.partitionColumnList,pagination:!1},null,8,["columns","data-source"])])):q("",!0),l("div",Ba,[l("p",Ua,p(r.$t("schema")),1),m(B,{"row-key":"field",columns:V(d),"data-source":e.schema,pagination:!1},null,8,["columns","data-source"])])]),l("div",ja,[e.changeMetrics&&e.changeMetrics.length?(c(),P("div",Ka,[l("p",qa,p(r.$t("changeTableMetrics")),1),m(B,{columns:V(E),"data-source":e.changeMetrics,pagination:!1},null,8,["columns","data-source"])])):q("",!0),l("div",Ga,[l("p",Ha,p(r.$t("baseTableMetrics")),1),m(B,{columns:V(E),"data-source":e.baseMetrics,pagination:!1},null,8,["columns","data-source"])]),l("div",Va,[l("p",Wa,p(r.$t("properties")),1),m(B,{columns:V(A),"data-source":e.properties,pagination:!1},null,8,["columns","data-source"])])]),e.detailLoading?(c(),G(Y,{key:0})):q("",!0)])}}}),Za=dt(Ya,[["__scopeId","data-v-1756822f"]]),Ja={class:"table-partitons"},Qa={class:"filter-wrap"},Xa=st({__name:"Files",props:{hasPartition:{type:Boolean}},setup(I){const y=I,_=K(!1),{t:k}=ft(),s=et([{title:k("partition"),dataIndex:"partition",ellipsis:!0},{title:k("fileCount"),dataIndex:"fileCount",width:120,ellipsis:!0},{title:k("size"),dataIndex:"size",width:120,ellipsis:!0},{title:k("lastCommitTime"),dataIndex:"lastCommitTime",width:200,ellipsis:!0}]),n=et([{title:k("file"),dataIndex:"file",ellipsis:!0},{title:k("fileType"),dataIndex:"fileType",width:120,ellipsis:!0},{title:k("size"),dataIndex:"size",width:120,ellipsis:!0},{title:k("commitTime"),dataIndex:"commitTime",width:200,ellipsis:!0},{title:k("commitId"),dataIndex:"commitId",width:200,ellipsis:!0},{title:k("path"),dataIndex:"path",ellipsis:!0,scopedSlots:{customRender:"path"}}]),i=W([]),t=W([]),a=K(""),u=K(0),e=K(!1),b=W(rt()),d=W(rt()),E=ut().query,A=W({catalog:"",db:"",table:"",...E}),r=K("");async function L(f){r.value=f,await B()}async function B(){try{e.value=!0,i.length=0;const f=await Yt({...A,filter:r.value,page:b.current,pageSize:b.pageSize}),{list:h,total:R}=f;b.total=R,(h||[]).forEach($=>{$.lastCommitTime=$.lastCommitTime?at($.lastCommitTime):"",i.push($)})}catch{}finally{e.value=!1}}function Y({current:f=1,pageSize:h=25}){!_.value&&y.hasPartition?(b.current=f,h!==b.pageSize&&(b.current=1),b.pageSize=h):(d.current=f,h!==d.pageSize&&(d.current=1),d.pageSize=h),H()}function H(){if(!y.hasPartition){Z();return}_.value?Z():B()}async function Z(){try{t.length=0,e.value=!0;const f={...A,partition:y.hasPartition?encodeURIComponent(a.value):null,specId:u.value,page:d.current,pageSize:d.pageSize},h=await Zt(f),{list:R,total:$}=h;d.total=$,(R||[]).forEach(T=>{T.commitTime=T.commitTime?at(T.commitTime):"",t.push(T)})}catch{}finally{e.value=!1}}function w(f){a.value=f.partition,u.value=f.specId,_.value=!_.value,_.value&&(d.current=1,Z())}return it(()=>{_.value=!1,y.hasPartition?B():Z()}),(f,h)=>{const R=ce,$=ue,T=re,N=ht,U=mt,X=St,M=Tt,tt=kt;return c(),P("div",Ja,[!_.value&&f.hasPartition?(c(),P(Q,{key:0},[l("div",Qa,[m(T,{value:r.value,"onUpdate:value":h[1]||(h[1]=S=>r.value=S),placeholder:f.$t("fileSearchPlaceholder"),style:{width:"350px"},onSearch:h[2]||(h[2]=S=>L(S))},Ut({prefix:o(()=>[m(R)]),_:2},[r.value?{name:"suffix",fn:o(()=>[m($,{class:"input-clear-icon",onClick:h[0]||(h[0]=S=>L(""))})]),key:"0"}:void 0]),1032,["value","placeholder"])]),m(U,{"row-key":"partiton",columns:V(s),"data-source":i,pagination:b,loading:e.value,onChange:Y},{bodyCell:o(({column:S,record:g})=>[S.dataIndex==="partition"?(c(),G(N,{key:0,type:"link",onClick:J=>w(g)},{default:o(()=>[j(p(g.partition),1)]),_:2},1032,["onClick"])):q("",!0)]),_:1},8,["columns","data-source","pagination","loading"])],64)):(c(),P(Q,{key:1},[f.hasPartition?(c(),G(M,{key:0,separator:">"},{default:o(()=>[m(X,{class:"text-active",onClick:w},{default:o(()=>[j(" All ")]),_:1}),m(X,null,{default:o(()=>[j(p(`${f.$t("partition")} ${a.value}`),1)]),_:1})]),_:1})):q("",!0),m(U,{"row-key":"file",columns:V(n),"data-source":t,pagination:d,loading:e.value,onChange:Y},{bodyCell:o(({column:S,record:g})=>[S.dataIndex==="file"?(c(),G(tt,{key:0},{title:o(()=>[j(p(g.file),1)]),default:o(()=>[l("span",null,p(g.file),1)]),_:2},1024)):q("",!0),S.dataIndex==="path"?(c(),G(tt,{key:1},{title:o(()=>[j(p(g.path),1)]),default:o(()=>[l("span",null,p(g.path),1)]),_:2},1024)):q("",!0)]),_:1},8,["columns","data-source","pagination","loading"])],64))])}}}),tn=dt(Xa,[["__scopeId","data-v-257203c0"]]);var Rt={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT © Zeno Rocha
 */(function(I,y){(function(k,s){I.exports=s()})(Ce,function(){return function(){var _={686:function(n,i,t){t.d(i,{default:function(){return Bt}});var a=t(279),u=t.n(a),e=t(370),b=t.n(e),d=t(817),O=t.n(d);function E(z){try{return document.execCommand(z)}catch{return!1}}var A=function(C){var v=O()(C);return E("cut"),v},r=A;function L(z){var C=document.documentElement.getAttribute("dir")==="rtl",v=document.createElement("textarea");v.style.fontSize="12pt",v.style.border="0",v.style.padding="0",v.style.margin="0",v.style.position="absolute",v.style[C?"right":"left"]="-9999px";var x=window.pageYOffset||document.documentElement.scrollTop;return v.style.top="".concat(x,"px"),v.setAttribute("readonly",""),v.value=z,v}var B=function(C,v){var x=L(C);v.container.appendChild(x);var D=O()(x);return E("copy"),x.remove(),D},Y=function(C){var v=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},x="";return typeof C=="string"?x=B(C,v):C instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(C==null?void 0:C.type)?x=B(C.value,v):(x=O()(C),E("copy")),x},H=Y;function Z(z){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Z=function(v){return typeof v}:Z=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},Z(z)}var w=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=C.action,x=v===void 0?"copy":v,D=C.container,F=C.target,nt=C.text;if(x!=="copy"&&x!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(F!==void 0)if(F&&Z(F)==="object"&&F.nodeType===1){if(x==="copy"&&F.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(x==="cut"&&(F.hasAttribute("readonly")||F.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(nt)return H(nt,{container:D});if(F)return x==="cut"?r(F):H(F,{container:D})},f=w;function h(z){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?h=function(v){return typeof v}:h=function(v){return v&&typeof Symbol=="function"&&v.constructor===Symbol&&v!==Symbol.prototype?"symbol":typeof v},h(z)}function R(z,C){if(!(z instanceof C))throw new TypeError("Cannot call a class as a function")}function $(z,C){for(var v=0;v<C.length;v++){var x=C[v];x.enumerable=x.enumerable||!1,x.configurable=!0,"value"in x&&(x.writable=!0),Object.defineProperty(z,x.key,x)}}function T(z,C,v){return C&&$(z.prototype,C),v&&$(z,v),z}function N(z,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function");z.prototype=Object.create(C&&C.prototype,{constructor:{value:z,writable:!0,configurable:!0}}),C&&U(z,C)}function U(z,C){return U=Object.setPrototypeOf||function(x,D){return x.__proto__=D,x},U(z,C)}function X(z){var C=S();return function(){var x=g(z),D;if(C){var F=g(this).constructor;D=Reflect.construct(x,arguments,F)}else D=x.apply(this,arguments);return M(this,D)}}function M(z,C){return C&&(h(C)==="object"||typeof C=="function")?C:tt(z)}function tt(z){if(z===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return z}function S(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function g(z){return g=Object.setPrototypeOf?Object.getPrototypeOf:function(v){return v.__proto__||Object.getPrototypeOf(v)},g(z)}function J(z,C){var v="data-clipboard-".concat(z);if(C.hasAttribute(v))return C.getAttribute(v)}var Ct=function(z){N(v,z);var C=X(v);function v(x,D){var F;return R(this,v),F=C.call(this),F.resolveOptions(D),F.listenClick(x),F}return T(v,[{key:"resolveOptions",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof D.action=="function"?D.action:this.defaultAction,this.target=typeof D.target=="function"?D.target:this.defaultTarget,this.text=typeof D.text=="function"?D.text:this.defaultText,this.container=h(D.container)==="object"?D.container:document.body}},{key:"listenClick",value:function(D){var F=this;this.listener=b()(D,"click",function(nt){return F.onClick(nt)})}},{key:"onClick",value:function(D){var F=D.delegateTarget||D.currentTarget,nt=this.action(F)||"copy",gt=f({action:nt,container:this.container,target:this.target(F),text:this.text(F)});this.emit(gt?"success":"error",{action:nt,text:gt,trigger:F,clearSelection:function(){F&&F.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(D){return J("action",D)}},{key:"defaultTarget",value:function(D){var F=J("target",D);if(F)return document.querySelector(F)}},{key:"defaultText",value:function(D){return J("text",D)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(D){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return H(D,F)}},{key:"cut",value:function(D){return r(D)}},{key:"isSupported",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],F=typeof D=="string"?[D]:D,nt=!!document.queryCommandSupported;return F.forEach(function(gt){nt=nt&&!!document.queryCommandSupported(gt)}),nt}}]),v}(u()),Bt=Ct},828:function(n){var i=9;if(typeof Element<"u"&&!Element.prototype.matches){var t=Element.prototype;t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}function a(u,e){for(;u&&u.nodeType!==i;){if(typeof u.matches=="function"&&u.matches(e))return u;u=u.parentNode}}n.exports=a},438:function(n,i,t){var a=t(828);function u(d,O,E,A,r){var L=b.apply(this,arguments);return d.addEventListener(E,L,r),{destroy:function(){d.removeEventListener(E,L,r)}}}function e(d,O,E,A,r){return typeof d.addEventListener=="function"?u.apply(null,arguments):typeof E=="function"?u.bind(null,document).apply(null,arguments):(typeof d=="string"&&(d=document.querySelectorAll(d)),Array.prototype.map.call(d,function(L){return u(L,O,E,A,r)}))}function b(d,O,E,A){return function(r){r.delegateTarget=a(r.target,O),r.delegateTarget&&A.call(d,r)}}n.exports=e},879:function(n,i){i.node=function(t){return t!==void 0&&t instanceof HTMLElement&&t.nodeType===1},i.nodeList=function(t){var a=Object.prototype.toString.call(t);return t!==void 0&&(a==="[object NodeList]"||a==="[object HTMLCollection]")&&"length"in t&&(t.length===0||i.node(t[0]))},i.string=function(t){return typeof t=="string"||t instanceof String},i.fn=function(t){var a=Object.prototype.toString.call(t);return a==="[object Function]"}},370:function(n,i,t){var a=t(879),u=t(438);function e(E,A,r){if(!E&&!A&&!r)throw new Error("Missing required arguments");if(!a.string(A))throw new TypeError("Second argument must be a String");if(!a.fn(r))throw new TypeError("Third argument must be a Function");if(a.node(E))return b(E,A,r);if(a.nodeList(E))return d(E,A,r);if(a.string(E))return O(E,A,r);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function b(E,A,r){return E.addEventListener(A,r),{destroy:function(){E.removeEventListener(A,r)}}}function d(E,A,r){return Array.prototype.forEach.call(E,function(L){L.addEventListener(A,r)}),{destroy:function(){Array.prototype.forEach.call(E,function(L){L.removeEventListener(A,r)})}}}function O(E,A,r){return u(document.body,E,A,r)}n.exports=e},817:function(n){function i(t){var a;if(t.nodeName==="SELECT")t.focus(),a=t.value;else if(t.nodeName==="INPUT"||t.nodeName==="TEXTAREA"){var u=t.hasAttribute("readonly");u||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),u||t.removeAttribute("readonly"),a=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var e=window.getSelection(),b=document.createRange();b.selectNodeContents(t),e.removeAllRanges(),e.addRange(b),a=e.toString()}return a}n.exports=i},279:function(n){function i(){}i.prototype={on:function(t,a,u){var e=this.e||(this.e={});return(e[t]||(e[t]=[])).push({fn:a,ctx:u}),this},once:function(t,a,u){var e=this;function b(){e.off(t,b),a.apply(u,arguments)}return b._=a,this.on(t,b,u)},emit:function(t){var a=[].slice.call(arguments,1),u=((this.e||(this.e={}))[t]||[]).slice(),e=0,b=u.length;for(e;e<b;e++)u[e].fn.apply(u[e].ctx,a);return this},off:function(t,a){var u=this.e||(this.e={}),e=u[t],b=[];if(e&&a)for(var d=0,O=e.length;d<O;d++)e[d].fn!==a&&e[d].fn._!==a&&b.push(e[d]);return b.length?u[t]=b:delete u[t],this}},n.exports=i,n.exports.TinyEmitter=i}},k={};function s(n){if(k[n])return k[n].exports;var i=k[n]={exports:{}};return _[n](i,i.exports,s),i.exports}return function(){s.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return s.d(i,{a:i}),i}}(),function(){s.d=function(n,i){for(var t in i)s.o(i,t)&&!s.o(n,t)&&Object.defineProperty(n,t,{enumerable:!0,get:i[t]})}}(),function(){s.o=function(n,i){return Object.prototype.hasOwnProperty.call(n,i)}}(),s(686)}().default})})(Rt);var en=Rt.exports;const an=Ie(en),nn=I=>({toClipboard(y,_){return new Promise((k,s)=>{const n=document.createElement("button"),i=new an(n,{text:()=>y,action:()=>"copy",container:_!==void 0?_:document.body});i.on("success",t=>{i.destroy(),k(t)}),i.on("error",t=>{i.destroy(),s(t)}),document.body.appendChild(n),n.click(),document.body.removeChild(n)})}}),on={class:"table-operations"},sn=["onClick"],ln=st({__name:"Operations",setup(I){const{toClipboard:y}=nn(),{t:_}=ft(),k=et([{title:_("time"),dataIndex:"ts",width:"30%"},{title:_("operation"),dataIndex:"operation",scopedSlots:{customRender:"operation"}}]),s=K(!1),n=K(""),i=W([]),t=K(!1),a=W(rt()),e=ut().query,b=W({catalog:"",db:"",table:"",...e});async function d(){try{t.value=!0,i.length=0;const L=await Jt({...b,page:a.current,pageSize:a.pageSize}),{total:B,list:Y}=L;a.total=B,(Y||[]).forEach(H=>{H.ts=H.ts?at(H.ts):"",i.push(H)})}catch{}finally{t.value=!1}}function O({current:L=1,pageSize:B=25}=a){a.current=L,B!==a.pageSize&&(a.current=1),a.pageSize=B,d()}function E(L){s.value=!0,n.value=L.operation}function A(){s.value=!1}async function r(){try{await y(n.value),de.success(_("copySuccess")),A()}catch{}}return it(()=>{d()}),(L,B)=>{const Y=mt,H=ht;return c(),P(Q,null,[l("div",on,[m(Y,{"row-key":"partiton",columns:V(k),"data-source":i,pagination:a,loading:t.value,onChange:O},{bodyCell:o(({column:Z,record:w})=>[Z.dataIndex==="operation"?(c(),P("span",{key:0,class:"text-active g-max-line-3",onClick:f=>E(w)},p(w.operation),9,sn)):q("",!0)]),_:1},8,["columns","data-source","pagination","loading"])]),m(V(zt),{open:s.value,width:560,title:L.$t("operationDetails"),class:"operation-wrap",onCancel:A},{footer:o(()=>[m(H,{type:"primary",onClick:r},{default:o(()=>[j(p(L.$t("copy")),1)]),_:1})]),default:o(()=>[j(p(n.value)+" ",1)]),_:1},8,["open","title"])],64)}}}),rn={class:"branch-selector"},cn={class:"branch-btn-label"},un={class:"branch-selector-search"},dn=["onClick"],pn={class:"item-icon"},fn={class:"item-label"},mn={key:1,class:"empty-tips"},hn=["onClick"],_n={class:"item-icon"},gn={class:"item-label"},vn={key:1,class:"empty-tips"},yn={class:"g-mr-4"},bn={class:"g-mr-4"},Cn={class:"g-ml-24"},In=st({__name:"Selector",props:{catalog:String,db:String,table:String,disabled:Boolean},emits:["refChange"],setup(I,{emit:y}){const _=I,k=y,s=pt(()=>_.disabled),n=K({value:"",type:ot.BRANCH,label:""}),i=K(""),t=K(""),a=K(ot.BRANCH),u=K([]),e=K([]),b=pt(()=>u.value.filter(w=>!i.value||w.label.includes(i.value))),d=pt(()=>e.value.filter(w=>!t.value||w.label.includes(t.value))),O=K(ct.ALL),E=W([ct.ALL,ct.OPTIMIZING,ct.NONOPTIMIZING]);function A(w){w.stopPropagation()}function r(w){return w.parentNode||document.body}function L(w){n.value=w,O.value=ct.ALL,k("refChange",{ref:w.value,operation:ct.ALL})}function B(w){k("refChange",{ref:n.value.value,operation:w})}async function Y(){const w=await Qt(_);u.value=(w.list||[]).map(f=>({value:f.name,label:f.name,type:ot.BRANCH})),u.value.length&&L(u.value[0])}async function H(){const w=await Xt(_);e.value=(w.list||[]).map(f=>({value:f.name,label:f.name,type:ot.TAG}))}async function Z(){await Promise.all([Y(),H()])}return it(()=>{a.value=ot.BRANCH,Z()}),(w,f)=>{const h=se,R=me,$=ht,T=he,N=_e,U=At,X=Nt,M=pe,tt=ge,S=fe;return c(),P("div",rn,[m(M,{trigger:["click"],placement:"bottomLeft","get-popup-container":r},{overlay:o(()=>[l("div",null,[l("div",un,[$t(m(T,{value:i.value,"onUpdate:value":f[0]||(f[0]=g=>i.value=g),placeholder:w.$t("filterBranchesOrTags"),onClick:A},null,8,["value","placeholder"]),[[wt,a.value===V(ot).BRANCH]]),$t(m(T,{value:t.value,"onUpdate:value":f[1]||(f[1]=g=>t.value=g),placeholder:w.$t("filterBranchesOrTags"),onClick:A},null,8,["value","placeholder"]),[[wt,a.value===V(ot).TAG]])]),m(X,{activeKey:a.value,"onUpdate:activeKey":f[2]||(f[2]=g=>a.value=g),type:"card"},{default:o(()=>[(c(),G(U,{key:V(ot).BRANCH,tab:w.$t("branches")},{default:o(()=>[b.value.length?(c(!0),P(Q,{key:0},lt(b.value,(g,J)=>(c(),P("div",{key:J,class:"branch-selector-item",onClick:Ct=>L(g)},[l("div",pn,[g.value===n.value.value?(c(),G(N,{key:0})):q("",!0)]),l("span",fn,p(g.label),1)],8,dn))),128)):(c(),P("span",mn,p(w.$t("nothingToShow")),1))]),_:1},8,["tab"])),(c(),G(U,{key:V(ot).TAG,tab:w.$t("tags")},{default:o(()=>[d.value.length?(c(!0),P(Q,{key:0},lt(d.value,(g,J)=>(c(),P("div",{key:J,class:"branch-selector-item",onClick:Ct=>L(g)},[l("div",_n,[g.value===n.value.value?(c(),G(N,{key:0})):q("",!0)]),l("span",gn,p(g.label),1)],8,hn))),128)):(c(),P("span",vn,p(w.$t("nothingToShow")),1))]),_:1},8,["tab"]))]),_:1},8,["activeKey"])])]),default:o(()=>[m($,{class:"branch-btn",disabled:!n.value.value||s.value},{default:o(()=>[m(h,{"class-name":"branch-selector-icon","icon-class":n.value.type,class:"g-mr-8"},null,8,["icon-class"]),l("span",cn,p(n.value.label),1),m(R)]),_:1},8,["disabled"])]),_:1}),l("div",null,[m(h,{"class-name":"branch-selector-icon","icon-class":"branch",class:"g-mr-4 g-ml-16"}),l("span",yn,p(u.value.length),1),l("span",null,p(w.$t("branches")),1)]),l("div",null,[m(h,{"class-name":"branch-selector-icon","icon-class":"tag",class:"g-mr-4 g-ml-16"}),l("span",bn,p(e.value.length),1),l("span",null,p(w.$t("tags")),1)]),l("div",Cn,[j(p(w.$t("operation"))+": ",1),m(S,{value:O.value,"onUpdate:value":f[3]||(f[3]=g=>O.value=g),class:"g-ml-8",style:{width:"160px"},disabled:s.value,onChange:B},{default:o(()=>[(c(!0),P(Q,null,lt(E,g=>(c(),G(tt,{key:g,value:g},{default:o(()=>[j(p(g),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value","disabled"])])])}}}),Tn=Object.freeze(Object.defineProperty({__proto__:null,Axis:Te,ChartView:Se,ComponentModel:ke,ComponentView:$e,List:we,Model:xe,PRIORITY:Ee,SeriesModel:De,color:Oe,connect:Le,dataTool:ze,dependencies:Ae,disConnect:Ne,disconnect:Pe,dispose:Fe,env:Me,extendChartView:Re,extendComponentModel:Be,extendComponentView:Ue,extendSeriesModel:je,format:Ke,getCoordinateSystemDimensions:qe,getInstanceByDom:Ge,getInstanceById:He,getMap:Ve,graphic:We,helper:Ye,init:Ze,innerDrawElementOnCanvas:Je,matrix:Qe,number:Xe,parseGeoJSON:Et,parseGeoJson:Et,registerAction:ta,registerCoordinateSystem:ea,registerLayout:aa,registerLoading:na,registerLocale:oa,registerMap:sa,registerPostInit:ia,registerPostUpdate:la,registerPreprocessor:ra,registerProcessor:ca,registerTheme:ua,registerTransform:da,registerUpdateLifecycle:pa,registerVisual:fa,setCanvasCreator:ma,setPlatformAPI:ha,throttle:_a,time:ga,use:Mt,util:va,vector:ya,version:ba,zrUtil:Ca,zrender:Ia},Symbol.toStringTag,{value:"Module"}));Mt([Ta,Sa,ka,$a,wa,xa,Ea,Da,Oa,La,za]);const Sn=st({props:{width:{type:String,default:"auto"},height:{type:String,default:"350px"},loading:{type:Boolean,default:!1},options:{type:Object,default:()=>{}}},setup(I){let y=null;const{options:_}=Lt(I),k=K(),s=()=>{y=Tn.init(k.value),y.setOption({..._.value})},n=()=>{y.setOption({..._.value}),y.resize()},i=()=>{y&&y.resize()};return bt(()=>_.value,t=>{t&&n()},{deep:!0}),jt(()=>{window.removeEventListener("resize",i)}),it(()=>{window.addEventListener("resize",i),s()}),{echart:k}}});function kn(I,y,_,k,s,n){const i=ve;return c(),G(i,{spinning:I.loading,class:"echarts-loading"},{default:o(()=>[l("div",{ref:"echart",style:It({width:I.width,height:I.height}),class:"timeline-echarts"},null,4)]),_:1},8,["spinning"])}const Dt=dt(Sn,[["render",kn]]);function $n(I={},y=(_,k)=>Number(_)-Number(k)){const _=Object.keys(I);if(!_.length)return{};const k={};return _.sort(y).forEach(s=>k[s]=I[s]),k}function Ot(I,y){if(!y)return{};y=$n(y);const _=Object.keys(y),k={tooltip:{trigger:"axis"},yAxis:{type:"value"},xAxis:{type:"category",data:_.map(n=>at(n)),axisTick:{alignWithLabel:!0,interval:0}},grid:{top:40,bottom:50}};I&&(k.title={left:"center",text:I});const s={};return Object.values(y).forEach(n=>{Object.keys(n).forEach(t=>{const a=ie.global.t(t);s[a]||(s[a]=[]),s[a].push(n[t])})}),k.legend={top:"bottom",data:Object.keys(s),lineStyle:{opacity:0}},k.series=Object.keys(s).map(n=>({name:n,type:"line",symbol:"circle",data:s[n]})),k}const wn={class:"table-snapshots"},xn=st({__name:"Snapshots",setup(I){const y=K(!1),{t:_}=ft(),k=et([{title:_("snapshotId"),dataIndex:"snapshotId",ellipsis:!0},{title:_("operation"),dataIndex:"operation"},{title:_("records"),dataIndex:"records"},{title:_("fileCount"),dataIndex:"fileCount"},{title:_("commitTime"),dataIndex:"commitTime"}]),s=et([{title:_("operation"),dataIndex:"operation",width:120,ellipsis:!0},{title:_("file"),dataIndex:"file",ellipsis:!0},{title:_("partition"),dataIndex:"partition",width:120},{title:_("fileType"),dataIndex:"fileType",width:120,ellipsis:!0},{title:_("size"),dataIndex:"size",width:120},{title:_("commitTime"),dataIndex:"commitTime",width:200,ellipsis:!0},{title:_("path"),dataIndex:"path",ellipsis:!0}]),n=W([]),i=W([]),t=K(""),a=K(!1),u=W(rt()),e=W(rt()),d=ut().query,O=W({catalog:"",db:"",table:"",...d}),E=K({}),A=K({}),r=K(""),L=K("");function B(h){r.value=h.ref,L.value=h.operation,Y()}async function Y(){try{a.value=!0,n.length=0;const h=await te({...O,ref:r.value,operation:L.value,page:u.current,pageSize:u.pageSize}),{list:R=[],total:$}=h,T={},N={};R.forEach(U=>{const{recordsSummaryForChart:X,filesSummaryForChart:M,commitTime:tt}=U;T[tt]=X||{},N[tt]=M||{},U.producer==="OPTIMIZE"&&(U.operation=`${U.operation}(optimizing)`),U.commitTime=U.commitTime?at(U.commitTime):"-",n.push(U)}),E.value=Ot(_("recordChartTitle"),T),A.value=Ot(_("fileChartTitle"),N),u.total=$}catch{}finally{a.value=!1}}function H({current:h=1,pageSize:R=25}){y.value?(e.current=h,R!==e.pageSize&&(e.current=1),e.pageSize=R):(u.current=h,R!==u.pageSize&&(u.current=1),u.pageSize=R),Z()}function Z(){y.value?w():Y()}async function w(){try{i.length=0,a.value=!0;const h={...O,snapshotId:t.value,page:e.current,pageSize:e.pageSize},R=await ee(h),{list:$,total:T}=R;e.total=T,$.forEach(N=>{N.commitTime=N.commitTime?at(N.commitTime):"",i.push(N)})}catch{}finally{a.value=!1}}function f(h){t.value=h.snapshotId,y.value=!y.value,y.value&&(e.current=1,w())}return it(()=>{y.value=!1}),(h,R)=>{const $=Ft,T=Pt,N=ht,U=mt,X=St,M=Tt,tt=kt;return c(),P("div",wn,[y.value?(c(),P(Q,{key:1},[m(M,{separator:">"},{default:o(()=>[m(X,{class:"text-active",onClick:f},{default:o(()=>[j(" All ")]),_:1}),m(X,null,{default:o(()=>[j(p(`${h.$t("snapshotId")} ${t.value}`),1)]),_:1})]),_:1}),m(U,{"row-key":"file",columns:V(s),"data-source":i,pagination:e,loading:a.value,class:"g-mt-8",onChange:H},{bodyCell:o(({column:S,record:g})=>[S.dataIndex==="path"?(c(),G(tt,{key:0},{title:o(()=>[j(p(g.path),1)]),default:o(()=>[l("span",null,p(g.path),1)]),_:2},1024)):q("",!0),S.dataIndex==="file"?(c(),G(tt,{key:1},{title:o(()=>[j(p(g.file),1)]),default:o(()=>[l("span",null,p(g.file),1)]),_:2},1024)):q("",!0)]),_:1},8,["columns","data-source","pagination","loading"])],64)):(c(),P(Q,{key:0},[m(T,null,{default:o(()=>[m($,{span:12},{default:o(()=>[m(Dt,{loading:a.value,options:E.value},null,8,["loading","options"])]),_:1}),m($,{span:12},{default:o(()=>[m(Dt,{loading:a.value,options:A.value},null,8,["loading","options"])]),_:1})]),_:1}),m(In,{catalog:O.catalog,db:O.db,table:O.table,disabled:a.value,onRefChange:B},null,8,["catalog","db","table","disabled"]),m(U,{"row-key":"snapshotId",columns:V(k),"data-source":n,pagination:u,loading:a.value,onChange:H},{bodyCell:o(({column:S,record:g})=>[S.dataIndex==="snapshotId"?(c(),G(N,{key:0,type:"link",onClick:J=>f(g)},{default:o(()=>[j(p(g.snapshotId),1)]),_:2},1032,["onClick"])):q("",!0)]),expandedRowRender:o(({record:S})=>[(c(!0),P(Q,null,lt(S.summary,(g,J)=>(c(),G(T,{key:J,type:"flex",gutter:16},{default:o(()=>[m($,{flex:"220px",style:{"text-align":"right"}},{default:o(()=>[j(p(J)+" : ",1)]),_:2},1024),m($,{flex:"auto"},{default:o(()=>[j(p(g),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["columns","data-source","pagination","loading"])],64))])}}}),En=dt(xn,[["__scopeId","data-v-9ac54d39"]]),_t=I=>(Kt("data-v-a2745137"),I=I(),qt(),I),Dn={class:"table-optimizing"},On={class:""},Ln=_t(()=>l("div",{class:""}," success / total ",-1)),zn={class:""},An=_t(()=>l("div",{class:""}," size / count ",-1)),Nn={class:""},Pn=_t(()=>l("div",{class:""}," size / count ",-1)),Fn={key:1,class:"g-flex-ac"},Mn={class:"tip-title"},Rn={class:""},Bn=_t(()=>l("div",{class:""}," size / count ",-1)),Un={class:""},jn=_t(()=>l("div",{class:""}," size / count ",-1)),Kn={key:1,class:"g-flex-ac"},qn={class:"tip-title"},Gn=st({__name:"Optimizing",setup(I){const y=K(!1),_=et({RUNNING:{title:"RUNNING",color:"#1890ff"},CLOSED:{title:"CLOSED",color:"#c9cdd4"},SUCCESS:{title:"SUCCESS",color:"#0ad787"},FAILED:{title:"FAILED",color:"#f5222d"}}),k=et({PLANNED:{title:"PLANNED",color:"#ffcc00"},SCHEDULED:{title:"SCHEDULED",color:"#4169E1"},ACKED:{title:"ACKED",color:"#1890ff"},FAILED:{title:"FAILED",color:"#f5222d"},SUCCESS:{title:"SUCCESS",color:"#0ad787"},CANCELED:{title:"CANCELED",color:"#c9cdd4"}}),{t:s}=ft(),n=et([{title:s("processId"),dataIndex:"processId"},{title:s("startTime"),dataIndex:"startTime",width:172},{title:s("type"),dataIndex:"optimizingType"},{title:s("status"),dataIndex:"status"},{title:s("duration"),dataIndex:"duration",width:120},{title:s("tasks"),dataIndex:"tasks"},{title:s("finishTime"),dataIndex:"finishTime",width:172},{title:s("input"),dataIndex:"inputFiles"},{title:s("output"),dataIndex:"outputFiles"}]),i=et([{title:s("taskId"),dataIndex:"taskId",width:82},{title:s("partition"),dataIndex:"partitionData",ellipsis:!0},{title:s("startTime"),dataIndex:"startTime",width:172},{title:s("status"),dataIndex:"status",width:124},{title:s("costTime"),dataIndex:"formatCostTime",width:120},{title:s("finishTime"),dataIndex:"endTime",width:172},{title:s("input"),dataIndex:"inputFilesDesc"},{title:s("output"),dataIndex:"outputFilesDesc"}]),t=W([]),a=K(0),u=W([]),e=K(!1),b=K(!0),d=W(rt()),O=W(rt()),A=ut().query,r=W({catalog:"",db:"",table:"",...A});async function L(){try{e.value=!0,t.length=0;const f=await ne({...r,page:d.current,pageSize:d.pageSize}),{list:h,total:R=0}=f;d.total=R,t.push(...[...h||[]].map($=>{const{inputFiles:T={},outputFiles:N={}}=$;return{...$,startTime:$.startTime?at($.startTime):"-",finishTime:$.finishTime?at($.finishTime):"-",optimizingType:$.optimizingType?$.optimizingType:"-",duration:xt($.duration||"-"),inputFiles:`${vt(T.totalSize)} / ${T.fileCnt}`,outputFiles:`${vt(N.totalSize)} / ${N.fileCnt}`,tasks:`${$.successTasks||"0"} / ${$.totalTasks||"0"}${$.runningTasks?` (${$.runningTasks} running)`:""}`}}))}catch{}finally{e.value=!1}}async function B(){zt.confirm({title:s("cancelOptimizingProcessOptModalTitle"),onOk:async()=>{var f;try{e.value=!0,await oe({...r,processId:(f=a.value)==null?void 0:f.toString()}),b.value=!0,H()}catch{}finally{e.value=!1}}})}function Y({current:f=1,pageSize:h=25}){y.value?(O.current=f,h!==O.pageSize&&(O.current=1),O.pageSize=h):(d.current=f,h!==d.pageSize&&(d.current=1),d.pageSize=h),H()}function H(){y.value?Z():L()}async function Z(){try{u.length=0,e.value=!0;const f={...r,processId:a.value,page:O.current,pageSize:O.pageSize},h=await ae(f),{list:R,total:$}=h;O.total=$,R.forEach(T=>{T.startTime=T.startTime?at(T.startTime):"-",T.endTime=T.endTime?at(T.endTime):"-",T.formatCostTime=xt(T.costTime),T.thread=T.optimizerToken?`(${T.threadId})${T.optimizerToken}`:"-",T.partitionData=T.partitionData?T.partitionData:"-",T.inputFilesDesc=`${vt(T.inputFiles.totalSize)} / ${T.inputFiles.fileCnt}`,T.outputFilesDesc=`${vt(T.outputFiles.totalSize)} / ${T.outputFiles.fileCnt}`,u.push(T)})}catch{}finally{e.value=!1}}function w(f,h){a.value=f,b.value=h!=="RUNNING",y.value=!y.value,y.value&&(O.current=1),H()}return it(()=>{y.value=!1,H()}),(f,h)=>{const R=ht,$=ye,T=kt,N=Ft,U=Pt,X=mt,M=St,tt=Tt;return c(),P("div",Dn,[y.value?(c(),P(Q,{key:1},[m(U,null,{default:o(()=>[m(N,{span:18},{default:o(()=>[m(tt,{separator:">"},{default:o(()=>[m(M,{class:"text-active",onClick:w},{default:o(()=>[j(" All ")]),_:1}),m(M,null,{default:o(()=>[j(p(`${f.$t("processId")} ${a.value}`),1)]),_:1})]),_:1})]),_:1}),m(N,{span:6},{default:o(()=>[m(R,{disabled:b.value,"onUpdate:disabled":h[0]||(h[0]=S=>b.value=S),type:"primary",class:"g-mb-16",style:{float:"right"},onClick:B},{default:o(()=>[j(p(V(s)("cancelProcess")),1)]),_:1},8,["disabled"])]),_:1})]),_:1}),m(X,{"row-key":"taskId",columns:V(i),"data-source":u,pagination:O,loading:e.value,class:"g-mt-8",onChange:Y},{headerCell:o(({column:S})=>[S.dataIndex==="inputFilesDesc"?(c(),P(Q,{key:0},[l("div",Rn,p(S.title),1),Bn],64)):q("",!0),S.dataIndex==="outputFilesDesc"?(c(),P(Q,{key:1},[l("div",Un,p(S.title),1),jn],64)):q("",!0)]),bodyCell:o(({column:S,record:g})=>[S.dataIndex==="partitionData"?(c(),G(T,{key:0},{title:o(()=>[j(p(g.partitionData),1)]),default:o(()=>[l("span",null,p(g.partitionData),1)]),_:2},1024)):q("",!0),S.dataIndex==="status"?(c(),P("div",Kn,[l("span",{style:It({"background-color":(V(k)[g.status]||{}).color}),class:"status-icon"},null,4),l("span",null,p(g.status),1),g.status==="FAILED"?(c(),G(T,{key:0,placement:"topRight",class:"g-ml-4","overlay-class-name":"table-failed-tip"},{title:o(()=>[l("div",qn,p(g.failReason),1)]),default:o(()=>[m($)]),_:2},1024)):q("",!0)])):q("",!0)]),expandedRowRender:o(({record:S})=>[(c(!0),P(Q,null,lt(S.summary,(g,J)=>(c(),G(U,{key:J,type:"flex",gutter:16},{default:o(()=>[m(N,{flex:"220px",style:{"text-align":"right"}},{default:o(()=>[j(p(J)+" : ",1)]),_:2},1024),m(N,{flex:"auto"},{default:o(()=>[j(p(g),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["columns","data-source","pagination","loading"])],64)):(c(),G(X,{key:0,"row-key":"processId",columns:V(n),"data-source":t,pagination:d,loading:e.value,onChange:Y},{headerCell:o(({column:S})=>[S.dataIndex==="tasks"?(c(),P(Q,{key:0},[l("div",On,p(S.title),1),Ln],64)):q("",!0),S.dataIndex==="inputFiles"?(c(),P(Q,{key:1},[l("div",zn,p(S.title),1),An],64)):q("",!0),S.dataIndex==="outputFiles"?(c(),P(Q,{key:2},[l("div",Nn,p(S.title),1),Pn],64)):q("",!0)]),bodyCell:o(({record:S,column:g})=>[g.dataIndex==="processId"?(c(),G(R,{key:0,type:"link",onClick:J=>w(S.processId,S.status)},{default:o(()=>[j(p(S.processId),1)]),_:2},1032,["onClick"])):q("",!0),g.dataIndex==="status"?(c(),P("div",Fn,[l("span",{style:It({"background-color":(V(_)[S.status]||{}).color}),class:"status-icon"},null,4),l("span",null,p(S.status),1),S.status==="FAILED"?(c(),G(T,{key:0,placement:"topRight",class:"g-ml-4","overlay-class-name":"table-failed-tip"},{title:o(()=>[l("div",Mn,p(S.failReason),1)]),default:o(()=>[m($)]),_:2},1024)):q("",!0)])):q("",!0)]),expandedRowRender:o(({record:S})=>[(c(!0),P(Q,null,lt(S.summary,(g,J)=>(c(),G(U,{key:J,type:"flex",gutter:16},{default:o(()=>[m(N,{flex:"220px",style:{"text-align":"right"}},{default:o(()=>[j(p(J)+" : ",1)]),_:2},1024),m(N,{flex:"auto"},{default:o(()=>[j(p(g),1)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["columns","data-source","pagination","loading"]))])}}}),Hn=dt(Gn,[["__scopeId","data-v-a2745137"]]),Vn=st({name:"Tables",components:{UDetails:Za,UFiles:tn,UOperations:ln,USnapshots:En,UOptimizing:Hn},setup(){const I=Gt(),y=ut(),_=le(),k=K(),s=et([{key:"Snapshots",label:"snapshots"},{key:"Optimizing",label:"optimizing"},{key:"Operations",label:"operations"}]),n=W({activeKey:"Details",isSecondaryNav:!1,baseInfo:{optimizingStatus:"",tableType:"",tableName:"",createTime:"",tableFormat:"",hasPartition:!1},detailLoaded:!1}),i=pt(()=>n.baseInfo.tableType==="ICEBERG"),t=b=>{n.detailLoaded=!0,n.baseInfo={...b}},a=b=>{const d={...y.query};d.tab=b.toString(),I.replace({query:{...d}})},u=()=>{_.updateTablesMenu(!1)},e=()=>{n.isSecondaryNav=!1,I.back()};return bt(()=>y.path,()=>{n.isSecondaryNav=!!y.path.includes("create")},{immediate:!0}),bt(()=>y.query,(b,d)=>{const{catalog:O,db:E,table:A}=b,{catalog:r,db:L,table:B}=d;if(`${O}${E}${A}`!=`${r}${L}${B}`){n.activeKey="Details";return}n.activeKey=b.tab}),it(()=>{var b;n.activeKey=((b=y.query)==null?void 0:b.tab)||"Details",Ht(()=>{k.value&&k.value.getTableDetails()})}),{...Lt(n),detailRef:k,tabConfigs:s,store:_,isIceberg:i,setBaseDetailInfo:t,hideTablesMenu:u,goBack:e,onChangeTab:a}}}),Wn={class:"tables-wrap"},Yn={key:0,class:"tables-content"},Zn={class:"g-flex-jsb"},Jn={class:"g-flex-col"},Qn={class:"g-flex"},Xn=["title"],to={class:"table-info g-flex-ac"},eo={class:"text-color"},ao={class:"text-color"},no={class:"text-color"},oo={class:"text-color"},so={class:"content"};function io(I,y,_,k,s,n){const i=be,t=yt("UDetails"),a=At,u=yt("UFiles"),e=Nt,b=yt("router-view");return c(),P("div",Wn,[I.isSecondaryNav?(c(),G(b,{key:1,onGoBack:I.goBack},null,8,["onGoBack"])):(c(),P("div",Yn,[l("div",Zn,[l("div",Jn,[l("div",Qn,[l("span",{title:I.baseInfo.tableName,class:"table-name g-text-nowrap"},p(I.baseInfo.tableName),9,Xn)]),l("div",to,[l("p",null,[j(p(I.$t("optimizingStatus"))+": ",1),l("span",eo,p(I.baseInfo.optimizingStatus),1)]),m(i,{type:"vertical"}),l("p",null,[j(p(I.$t("records"))+": ",1),l("span",ao,p(I.baseInfo.records),1)]),m(i,{type:"vertical"}),I.isIceberg?q("",!0):(c(),P(Q,{key:0},[l("p",null,[j(p(I.$t("createTime"))+": ",1),l("span",no,p(I.baseInfo.createTime),1)]),m(i,{type:"vertical"})],64)),l("p",null,[j(p(I.$t("tableFormat"))+": ",1),l("span",oo,p(I.baseInfo.tableFormat),1)])])])]),l("div",so,[m(e,{activeKey:I.activeKey,"onUpdate:activeKey":y[0]||(y[0]=d=>I.activeKey=d),"destroy-inactive-tab-pane":"",onChange:I.onChangeTab},{default:o(()=>[m(a,{key:"Details",tab:I.$t("details"),"force-render":""},{default:o(()=>[m(t,{ref:"detailRef",onSetBaseDetailInfo:I.setBaseDetailInfo},null,8,["onSetBaseDetailInfo"])]),_:1},8,["tab"]),I.detailLoaded?(c(),G(a,{key:"Files",tab:I.$t("files")},{default:o(()=>[m(u,{"has-partition":I.baseInfo.hasPartition},null,8,["has-partition"])]),_:1},8,["tab"])):q("",!0),(c(!0),P(Q,null,lt(I.tabConfigs,d=>(c(),G(a,{key:d.key,tab:I.$t(d.label)},{default:o(()=>[(c(),G(Vt(`U${d.key}`)))]),_:2},1032,["tab"]))),128))]),_:1},8,["activeKey","onChange"])])]))])}const Co=dt(Vn,[["render",io],["__scopeId","data-v-260a4c8e"]]);export{Co as default};
